<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DI Container Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
            background: #2a2a2a;
        }
        .result {
            background: #333;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #357abd;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
    </style>
</head>
<body>
    <h1>üîç DI Container Test</h1>
    
    <div class="test-section">
        <h3>Test 1: DI Container Import</h3>
        <button onclick="testDIContainerImport()">Test DI Container Import</button>
        <div id="diContainerResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>Test 2: Use Case Resolution</h3>
        <button onclick="testUseCaseResolution()">Test Use Case Resolution</button>
        <div id="useCaseResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>Test 3: Crypto Data Fetch</h3>
        <button onclick="testCryptoDataFetch()">Test Crypto Data Fetch</button>
        <div id="cryptoDataResult" class="result"></div>
    </div>

    <script type="module">
        // Test 1: DI Container Import
        window.testDIContainerImport = async function() {
            const resultDiv = document.getElementById('diContainerResult');
            resultDiv.innerHTML = 'Testing...';
            
            try {
                // –ü–æ–ø—Ä–æ–±—É–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                const { DependencyContainer } = await import('/src/Shared/infrastructure/DependencyContainer.ts');
                resultDiv.innerHTML = '<span class="success">‚úÖ SUCCESS: DI Container imported!</span>\n' +
                    'DependencyContainer: ' + typeof DependencyContainer + '\n' +
                    'getInstance: ' + typeof DependencyContainer.getInstance;
            } catch (error) {
                resultDiv.innerHTML = '<span class="error">‚ùå ERROR: DI Container import failed</span>\n' +
                    'Error: ' + error.message + '\n' +
                    'Stack: ' + error.stack;
            }
        };

        // Test 2: Use Case Resolution
        window.testUseCaseResolution = async function() {
            const resultDiv = document.getElementById('useCaseResult');
            resultDiv.innerHTML = 'Testing...';
            
            try {
                // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥—É–ª–∏
                const { DependencyContainer } = await import('/src/Shared/infrastructure/DependencyContainer.ts');
                const { CryptoDataDependencyConfig } = await import('/src/CryptoData/Infrastructure/config/DependencyConfig.ts');
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º
                const container = DependencyContainer.getInstance();
                CryptoDataDependencyConfig.configure(container);
                
                // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑—Ä–µ—à–∏—Ç—å use case
                const useCase = container.resolve('GetCryptoDataUseCase');
                
                resultDiv.innerHTML = '<span class="success">‚úÖ SUCCESS: Use Case resolved!</span>\n' +
                    'Use Case: ' + typeof useCase + '\n' +
                    'Execute method: ' + typeof useCase.execute;
            } catch (error) {
                resultDiv.innerHTML = '<span class="error">‚ùå ERROR: Use Case resolution failed</span>\n' +
                    'Error: ' + error.message + '\n' +
                    'Stack: ' + error.stack;
            }
        };

        // Test 3: Crypto Data Fetch
        window.testCryptoDataFetch = async function() {
            const resultDiv = document.getElementById('cryptoDataResult');
            resultDiv.innerHTML = 'Testing...';
            
            try {
                // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥—É–ª–∏
                const { DependencyContainer } = await import('/src/Shared/infrastructure/DependencyContainer.ts');
                const { CryptoDataDependencyConfig } = await import('/src/CryptoData/Infrastructure/config/DependencyConfig.ts');
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º
                const container = DependencyContainer.getInstance();
                CryptoDataDependencyConfig.configure(container);
                
                // –ü–æ–ª—É—á–∞–µ–º use case
                const useCase = container.resolve('GetCryptoDataUseCase');
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å
                const result = await useCase.execute({
                    symbol: 'BTCUSDT',
                    timeframe: '1h',
                    limit: 100
                });
                
                resultDiv.innerHTML = '<span class="success">‚úÖ SUCCESS: Crypto data fetched!</span>\n' +
                    'Result success: ' + result.isSuccess + '\n' +
                    'Data length: ' + (result.isSuccess ? result.value.data.length : 'N/A') + '\n' +
                    'First item: ' + (result.isSuccess ? JSON.stringify(result.value.data[0], null, 2) : 'N/A');
            } catch (error) {
                resultDiv.innerHTML = '<span class="error">‚ùå ERROR: Crypto data fetch failed</span>\n' +
                    'Error: ' + error.message + '\n' +
                    'Stack: ' + error.stack;
            }
        };
    </script>
</body>
</html> 